比特币网络是一个分布式的点对点网络，与zookeeper这类的分布式系统的区别是它存在拜占庭故障，拜占庭故障就是拜占庭将军问题的失败结果，即系统中可能存在撒谎的节点。

为了避免拜占庭故障，节点之间必须要达成一致，bitcoin采用了POW的共识机制，POW允许第一个计算出hash函数的节点才拥有发送消息的权利（就达成了一致），解题的节点会获得比特币的激励。保证了系统中所有节点能够达成一致。



而POS是通过质押货币然后随机来拥有发送消息的权利，欺骗的成本就是质押代币的价值。



以太坊的另一个不同是，以太坊比比特币多了一个智能合约系统，普通的用户账户只有地址和余额，以太坊的智能合约账户还拥有「状态」和「代码」，EVM可以执行用户自定义的代码。

1. 地址：
2. 余额：
3. 代码：可以在EVM中运行的字节码，它是在创建智能合约时执行的代码。
4. 状态：智能合约中变量的当前状态。



创建一个合约就是发送一笔交易：

```json
{
    to: '',  // to为空时表示创建合约
    value: 0.0
    data: ‘0x6060604052341561000c57xlb60405160c0806……………’ // 智能合约代码
}
```

当to为null时，表明这是一个智能合约的部署，那么evm就会执行data中的代码，部署会进行构造函数初始化。

当合约被部署完成之后，如果需要调用代码中的方法，就需要再发送一次交易。

```json
{
    from: "the address of yourself"
    to: '0x687422eEA2cB73B5d3e242bA5456b782919AFc85’, //合约
    value: 0.0
    data: ‘0x6060604052341561000c57fe5b60405160c0806aaa……………’
}
```

to就是这个智能合约的地址，value就是向这个合约账户转账的eth，data就是调用哪个方法 和 入参。

这个交易被执行时就会执行这个方法，就完成了一次合约调用。



不论是合约部署还是调用合约，其实都是一次交易的过程。



智能合约最广泛的用途之一就是ICO，发行一定数量的代币，只需要记录下每个用户的token数量，并具有转账、查询余额等功能。ERC20就是定义了一种这些功能的规范。



还有一个出名的是ERC721，与ERC20的区别是每一个合约地址都有一个唯一的ID，如果将合约用来创建一张图片，图片和url存储在分布式存储IPFS中，IPFS生成一个CID，将这个CID记录为合约地址唯一的ID，就可以实现这个图片的所有者是独一无二的一个人。ERC721的一个成功应用就是近来流行的NFT。



值得一题的是，近来比特币也出现了NFT，它是通过bitcoin交易脚本code OP_RETURN来实现的，

OP_RETURN如果有值会无效化交易，所以它可以将一些信息永久记录下来。Ordinal NFT是使用这个实现的，具体实现细节尚未考证。
