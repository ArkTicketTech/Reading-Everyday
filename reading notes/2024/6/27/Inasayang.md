# Learning OpenTelemetry Setting Up and Operating a Modern Observability System pp. 25-31

## ch3.OpenTelemetry Overview

### Primary Observability Signals

instrumentation是向服务或系统添加可观察性代码的过程。

- “白盒”方法，涉及直接向服务或库添加遥测代码
- “黑盒”方法，利用外部代理或库生成遥测，而无需直接更改代码

OpenTelemetry 主要关注三种主要信号：追踪（traces）、指标（metrics）和日志（logs）

- 使用实际生产数据和服务之间的通信来捕捉系统中服务之间的关系
- 用一致且描述性的元数据注释服务遥测数据，说明服务在做什么以及它运行的位置
- 明确识别任意测量组之间的关系——基本上是“这件事发生时，另一件事也发生了”
- 有效地创建系统中事件发生的准确计数和测量，例如请求发生的次数，或者多少请求在100到150毫秒之间完成

#### Traces

追踪（trace）是建模分布式系统中工作的方式。

每个追踪是给定事务的一组相关日志，称为跨度（spans）。每个跨度又包含各种字段。

- 一个追踪代表一次事务，或一次通过分布式系统的旅程。这使得追踪成为建模终端用户体验的最佳方式，因为一个追踪对应一个用户在系统中的路径
- 可以跨多个维度聚合一组追踪，以发现其他方式难以发现的性能特征
- 追踪可以转化为其他信号，例如指标，从而在不丢失关键性能信息的情况下对原始数据进行降采样。换句话说，一个追踪包含了计算单个请求的“黄金信号”（延迟、流量、错误和饱和度）所需的所有信息

黄金信号是对系统进行的四个关键测量

- 延迟（Latency）：处理一个请求所需的时间
- 流量（Traffic）：请求的数量
- 错误（Errors）：请求失败的比率
- 饱和度（Saturation）：系统资源的利用率

#### Metrics

指标（metrics）是系统状态的数值测量和记录，例如同时登录系统的用户数量、设备上使用的磁盘空间量或虚拟机（VM）上可用的RAM量。

指标通常是开发人员试图了解整体系统健康状况的首选方法。

#### Logs

通常，通过对齐时间窗口（例如“09:30:25到09:31:07之间发生了什么”）或比较共享属性来关联日志数据与追踪或指标。

没有标准的方法来包含统一的元数据，或将日志信号与追踪和指标链接起来，以发现因果关系。分布式系统（如云原生架构中常见的系统）通常会收集到来自系统不同组件的高度分散的日志，并且这些日志经常集中在不同的工具中。

从根本上说，OpenTelemetry 模型旨在通过将日志语句与追踪上下文和记录的指标、追踪链接起来来统一这些信号。简单来说，OpenTelemetry 可以获取应用程序代码中的现有日志语句，查看是否存在上下文，如果存在，则确保日志语句与该上下文相关联。
