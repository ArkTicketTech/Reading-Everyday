later a virus infects system and modifies system files. User reboots into clean OS and supplies his password. Then secure MAC all modified files will be detected.

MAC is a pair of algorithm. signing algorithm,given a message and a key will generate a tag. the second is a verification algorithn given a key a message a tag will output 0 or 1. depending on a tag is valid or not.
a mac is secure if it is existentially unforgeable under a chosen message attack.
