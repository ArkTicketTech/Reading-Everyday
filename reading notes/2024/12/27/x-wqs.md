## 什么是认证加密?

认证加密是一种密码系统,其中:

- 加密算法像往常一样接收密钥、消息和可选的nonce作为输入,输出密文
- 解密算法除了输出消息外,还允许输出一个特殊符号"⊥"(bottom)
- 当解密算法输出"⊥"时,表示密文无效应被忽略
- "⊥"不在消息空间中,是一个表示密文应被拒绝的唯一符号

## 认证加密的安全性要求

认证加密系统需要满足两个性质:

1. 在选择明文攻击下语义安全(CPA安全)
2. 密文完整性(ciphertext integrity)

### 密文完整性游戏

设(E,D)是一个消息空间为M的密码系统:

1. 挑战者首先选择一个随机密钥K
2. 攻击者可以提交任意消息并获得其加密:
   - 提交M1获得密文C1 = E(K,M1)
   - 提交M2获得密文C2 = E(K,M2)
   - ...直到Mq获得密文Cq

攻击者的目标是产生一个新的有效密文。如果该密文满足以下条件,则攻击者获胜:
- 解密结果不是"⊥"
- 这是一个新密文(不是之前获得的q个密文之一)

我们将攻击者在密文完整性游戏中的优势定义为挑战者输出1的概率。如果对于所有高效攻击者,这个优势都是可忽略的,则称该密码系统具有密文完整性。

## 认证加密的定义

一个密码系统具有认证加密性质,当且仅当它:
1. 在选择明文攻击下语义安全
2. 具有密文完整性

### 反例:带随机IV的CBC模式

CBC模式虽然是CPA安全的,但不提供认证加密。因为攻击者可以轻易赢得密文完整性游戏:
- 提交任意随机密文
- CBC解密算法永远不会输出"⊥"
- 任何随机密文都会解密为某个消息
- 攻击者直接赢得密文完整性游戏

## 认证加密的两个重要含义

### 1. 真实性(Authenticity)

攻击者无法欺骗接收者Bob相信Alice发送了她实际上没有发送的消息:
- 攻击者可以与Alice交互,让她加密任意消息(选择明文攻击)
- 但攻击者无法产生一个不是由Alice创建的有效密文
- 当Bob收到一个能正确解密的密文时,他知道该消息一定来自知道密钥K的人
- 如果只有Alice知道K,则密文一定来自Alice而非攻击者的修改

**注意**: 认证加密不能防范重放攻击:
- 攻击者可以截获Alice发给Bob的密文并重放
- 例如:Alice发送"转账$100给Charlie",Charlie可以重放该密文导致Bob再次转账
- 任何加密协议都需要额外机制来防范重放攻击
- 我们将在后续章节讨论重放攻击

### 2. 防范选择密文攻击

认证加密可以防范一种非常强大的攻击者 - 能够进行选择密文攻击的攻击者。
