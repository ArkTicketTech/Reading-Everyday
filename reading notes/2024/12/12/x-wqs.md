一、MAC的基本概念
MAC是一对算法：签名算法(生成标签)和验证算法(验证标签)
MAC的安全性要求：在选择消息攻击下存在性不可伪造
攻击者即使能获得任意消息的标签，也无法为新消息创建有效标签
二、基于PRF构建MAC
任何安全的PRF都可以直接构建安全的MAC
基本方法：
签名：对消息M计算PRF(M)作为标签
验证：重新计算PRF(M)并与给定标签比对
三、MAC的安全性要求
PRF的输出长度必须足够长
例如：10位输出的PRF不安全(成功伪造概率1/1024)
建议：至少80位输出以确保安全性(伪造概率≤1/2^80)
四、从小MAC构建大MAC的方法
1. CBC-MAC
主要用于银行业务(如ACH系统)
可处理大型消息
HMAC
用于互联网协议(SSL、IPsec、SSH等)
同样支持大型消息处理
五、MAC输出截断特性
N位PRF可以安全截断到T位(T<N)
截断后仍保持安全性
实践建议：
不安全：截断到3位
安全：截断到64位或80位
AES(128位)可以安全截断到更小的标签长度
六、应用示例
AES作为基础PRF：
输入空间：16字节(128位)
可以作为小消息MAC的基础
通过CBC-MAC或HMAC扩展处理更大消息
