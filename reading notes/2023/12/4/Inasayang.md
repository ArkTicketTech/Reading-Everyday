# Ch 1

数据库用于不同的目的

-   临时热数据
-   长期冷数据的存储
-   复杂的分析查询
-   只通过键值访问
-   专门存储时间序列数据
-   高效存储二进制大对象BLOB



数据库三大分类

-   OLTP
-   OLAP
-   HTAP



客户端请求通过传输子系统到达数据库，传输子系统还负责与数据库集群中的其他节点通信

收到查询后，传输子系统讲查询移交给查询处理器，进行语法解析，解释和验证。数据库再执行访问控制检查

解析后的查询被传递给查询优化器，先消除不可能执行的部分和冗余的部分，根据内部统计信息和数据分布，找到查询的最高效方法

查询以执行计划的形式呈现，由于执行同一个查询的不同执行计划存在效率上的差异，所以优化器会挑选出最优的

执行计划由执行引擎处理，收集本地和远程的执行结果

本地查询由存储引擎执行，存储引擎的组件

-   事务管理器
-   锁管理器
-   访问方法（存储结构）
-   缓冲区管理器
-   恢复管理器

事务管理器和锁管理器负责并发控制



数据库在认定操作完成之前，必须先将其结果写到一个顺序日志文件

为了避免在启动过程中或崩溃后重放完整的日志内容，内存数据库维护了一个备份副本，一个基于磁盘且已排序的数据结构，并且对改结构的修改是异步且分批处理



日志数据库通常用于批量备份，处理该批日志数据后，备份将持有截止到特定时间点的数据库快照，因此可以丢弃之前的日志内容，这个过程称为生成检查点（checkpointing），会更新磁盘的数据库快照。